library(tidyverse)

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                   Part 1                                 ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
d <- "01/data.txt" |>
  read_lines() |>
  as.numeric() |>
  enframe(value = "x")

d_1 <-
  d |>
  mutate(
    diff = x - lag(x)
  ) |>
  summarize(
    x = sum(diff > 0, na.rm = TRUE)
  )

d_1

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                   Part 2                                 ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
d_2 <- d

d_2$y <- rollsum(d$x, 3, align = "left", fill = 0)

d_2 |>
  mutate(
    diff = y - lag(y)
  ) |>
  summarize(
    y = sum(diff > 0, na.rm = TRUE)
  )
